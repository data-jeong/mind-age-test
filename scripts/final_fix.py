#!/usr/bin/env python3
import json
import random
from datetime import datetime
from collections import defaultdict
import re

# 2025년 트렌드에 맞는 완전히 새로운 질문 세트
FRESH_QUESTIONS = {
    "daily_life": [
        {"q": "아침 알람은 몇 개나 맞춰놓으시나요?", "a": [
            {"t": "한 개로 충분", "v": 40},
            {"t": "3개 정도", "v": 30},
            {"t": "5개 이상", "v": 20},
            {"t": "알람 없이 일어남", "v": 45}
        ]},
        {"q": "엘리베이터에서 문 닫힘 버튼을?", "a": [
            {"t": "연타해서 누름", "v": 25},
            {"t": "한 번만 누름", "v": 35},
            {"t": "안 누르고 기다림", "v": 40},
            {"t": "계단 이용함", "v": 30}
        ]},
        {"q": "길에서 아는 사람을 만났을 때?", "a": [
            {"t": "반갑게 인사", "v": 35},
            {"t": "못 본 척", "v": 25},
            {"t": "눈인사만", "v": 30},
            {"t": "먼저 발견하면 피함", "v": 20}
        ]},
        {"q": "밥 먹고 바로 양치질을?", "a": [
            {"t": "바로 함", "v": 35},
            {"t": "30분 후에", "v": 40},
            {"t": "자기 전에만", "v": 20},
            {"t": "생각날 때", "v": 25}
        ]},
        {"q": "화장실에서 핸드폰을?", "a": [
            {"t": "필수품", "v": 20},
            {"t": "가끔 가져감", "v": 30},
            {"t": "안 가져감", "v": 40},
            {"t": "일부러 두고 감", "v": 35}
        ]},
    ],
    
    "digital_habits": [
        {"q": "배터리 잔량이 몇 %일 때 불안하신가요?", "a": [
            {"t": "50% 이하", "v": 25},
            {"t": "30% 이하", "v": 30},
            {"t": "20% 이하", "v": 35},
            {"t": "10% 이하", "v": 20}
        ]},
        {"q": "앱 업데이트는 언제 하시나요?", "a": [
            {"t": "자동 업데이트", "v": 30},
            {"t": "알림 뜨면 바로", "v": 25},
            {"t": "몰아서 한 번에", "v": 35},
            {"t": "꼭 필요할 때만", "v": 40}
        ]},
        {"q": "스마트폰 홈 화면 정리는?", "a": [
            {"t": "깔끔하게 폴더 정리", "v": 35},
            {"t": "자주 쓰는 것만 밖에", "v": 30},
            {"t": "막 흩어져 있음", "v": 20},
            {"t": "기본 상태 그대로", "v": 40}
        ]},
        {"q": "읽지 않은 알림 개수가 쌓이면?", "a": [
            {"t": "바로바로 확인", "v": 30},
            {"t": "100개 넘으면 정리", "v": 25},
            {"t": "신경 안 씀", "v": 20},
            {"t": "모두 읽음 처리", "v": 35}
        ]},
        {"q": "와이파이 비밀번호를 잊어버리면?", "a": [
            {"t": "공유기 뒤에서 확인", "v": 35},
            {"t": "저장된 기기에서 확인", "v": 30},
            {"t": "초기화하고 새로 설정", "v": 25},
            {"t": "그냥 데이터 씀", "v": 20}
        ]},
    ],
    
    "food_culture": [
        {"q": "라면 물 양은 어떻게 맞추시나요?", "a": [
            {"t": "정확히 계량", "v": 40},
            {"t": "눈대중으로", "v": 30},
            {"t": "국물 많이", "v": 25},
            {"t": "꾸덕하게", "v": 20}
        ]},
        {"q": "치킨 먹을 때 무는?", "a": [
            {"t": "무 안 먹음", "v": 20},
            {"t": "치킨이랑 같이", "v": 30},
            {"t": "입가심용으로", "v": 35},
            {"t": "무만 따로 더 시킴", "v": 25}
        ]},
        {"q": "떡볶이에 뭘 추가하시나요?", "a": [
            {"t": "순대, 튀김, 김밥 풀세트", "v": 25},
            {"t": "치즈나 계란", "v": 20},
            {"t": "떡볶이만", "v": 35},
            {"t": "라면 사리", "v": 30}
        ]},
        {"q": "편의점에서 도시락 고를 때?", "a": [
            {"t": "신상품 도전", "v": 25},
            {"t": "늘 먹던 것", "v": 35},
            {"t": "할인하는 것", "v": 30},
            {"t": "칼로리 확인하고", "v": 40}
        ]},
        {"q": "김치는 어떻게 드시나요?", "a": [
            {"t": "익은 김치", "v": 35},
            {"t": "겉절이", "v": 25},
            {"t": "다 좋아함", "v": 30},
            {"t": "김치 안 먹음", "v": 20}
        ]},
    ],
    
    "social_situations": [
        {"q": "모임에서 사진 찍자고 하면?", "a": [
            {"t": "적극적으로 포즈", "v": 25},
            {"t": "어색하지만 참여", "v": 30},
            {"t": "뒤로 빠짐", "v": 35},
            {"t": "사진 찍어주는 역할", "v": 40}
        ]},
        {"q": "식당에서 주문할 때 결정은?", "a": [
            {"t": "미리 정해서 감", "v": 35},
            {"t": "메뉴판 보고 즉석에서", "v": 30},
            {"t": "다른 사람 따라서", "v": 25},
            {"t": "직원 추천 메뉴", "v": 20}
        ]},
        {"q": "대화 중 침묵이 흐르면?", "a": [
            {"t": "새로운 화제 꺼내기", "v": 30},
            {"t": "어색해서 핸드폰 보기", "v": 25},
            {"t": "침묵도 편안함", "v": 40},
            {"t": "일단 웃기", "v": 20}
        ]},
        {"q": "칭찬을 받았을 때 반응은?", "a": [
            {"t": "겸손하게 부정", "v": 35},
            {"t": "고맙다고 수긍", "v": 30},
            {"t": "어색해서 화제 전환", "v": 25},
            {"t": "맞장구치며 인정", "v": 20}
        ]},
        {"q": "회식 2차는 어떻게 하시나요?", "a": [
            {"t": "1차만 참석", "v": 35},
            {"t": "분위기 봐서", "v": 30},
            {"t": "끝까지 참석", "v": 25},
            {"t": "회식 자체를 안 감", "v": 40}
        ]},
    ],
    
    "money_matters": [
        {"q": "현금은 얼마나 가지고 다니시나요?", "a": [
            {"t": "0원 (카드만)", "v": 25},
            {"t": "만원 정도", "v": 30},
            {"t": "5만원 이상", "v": 40},
            {"t": "비상금 조금", "v": 35}
        ]},
        {"q": "더치페이 할 때 1원 단위는?", "a": [
            {"t": "정확히 N분의 1", "v": 25},
            {"t": "천원 단위로 반올림", "v": 30},
            {"t": "만원 단위로 대충", "v": 35},
            {"t": "내가 다 낼게", "v": 40}
        ]},
        {"q": "택시비가 애매하게 나오면?", "a": [
            {"t": "카드로 정확히", "v": 30},
            {"t": "거스름돈 안 받음", "v": 35},
            {"t": "현금 없어서 카드", "v": 25},
            {"t": "택시 안 탐", "v": 20}
        ]},
        {"q": "적금 만기가 되면?", "a": [
            {"t": "바로 재가입", "v": 40},
            {"t": "일단 통장에", "v": 30},
            {"t": "투자 상품으로", "v": 35},
            {"t": "쓸 데가 있어서", "v": 20}
        ]},
        {"q": "카드 명세서 확인은?", "a": [
            {"t": "매달 꼼꼼히", "v": 40},
            {"t": "금액만 대충", "v": 30},
            {"t": "가끔 확인", "v": 25},
            {"t": "자동이체라 모름", "v": 20}
        ]},
    ],
    
    "shopping_style": [
        {"q": "온라인 장바구니 관리는?", "a": [
            {"t": "깔끔하게 비움", "v": 35},
            {"t": "담아만 놓음", "v": 25},
            {"t": "세일 기다리며 보관", "v": 30},
            {"t": "충동구매 직행", "v": 20}
        ]},
        {"q": "옷 살 때 고민 시간은?", "a": [
            {"t": "즉시 결정", "v": 25},
            {"t": "하루 정도", "v": 30},
            {"t": "일주일 고민", "v": 35},
            {"t": "결국 안 삼", "v": 40}
        ]},
        {"q": "마트에서 장 볼 때?", "a": [
            {"t": "리스트 작성해서", "v": 40},
            {"t": "필요한 것만", "v": 35},
            {"t": "이것저것 담음", "v": 25},
            {"t": "배달 주문함", "v": 30}
        ]},
        {"q": "신발은 몇 켤레나 가지고 계신가요?", "a": [
            {"t": "3켤레 이하", "v": 40},
            {"t": "5켤레 정도", "v": 35},
            {"t": "10켤레 이상", "v": 25},
            {"t": "셀 수 없음", "v": 20}
        ]},
        {"q": "세일 기간에는?", "a": [
            {"t": "미리 찜해둔 것만", "v": 35},
            {"t": "일단 구경", "v": 30},
            {"t": "지름신 강림", "v": 20},
            {"t": "세일 안 기다림", "v": 40}
        ]},
    ],
    
    "entertainment": [
        {"q": "넷플릭스 보다가 잠들면?", "a": [
            {"t": "다음날 이어보기", "v": 30},
            {"t": "처음부터 다시", "v": 35},
            {"t": "대충 넘어감", "v": 25},
            {"t": "수면 타이머 설정", "v": 40}
        ]},
        {"q": "유튜브 추천 영상은?", "a": [
            {"t": "취향 저격", "v": 25},
            {"t": "가끔 신선함", "v": 30},
            {"t": "이상한 것만 뜸", "v": 20},
            {"t": "추천 안 봄", "v": 35}
        ]},
        {"q": "드라마 정주행은?", "a": [
            {"t": "하루만에 완주", "v": 20},
            {"t": "주말에 몰아서", "v": 25},
            {"t": "매일 1-2편씩", "v": 35},
            {"t": "본방 사수", "v": 40}
        ]},
        {"q": "음악 들을 때 볼륨은?", "a": [
            {"t": "최대 볼륨", "v": 20},
            {"t": "적당히 크게", "v": 25},
            {"t": "작게 배경음악", "v": 35},
            {"t": "이어폰 안 씀", "v": 40}
        ]},
        {"q": "영화 엔딩 크레딧은?", "a": [
            {"t": "끝까지 감상", "v": 35},
            {"t": "쿠키 영상만", "v": 30},
            {"t": "바로 나감", "v": 25},
            {"t": "핸드폰 하며 기다림", "v": 20}
        ]},
    ],
    
    "personal_habits": [
        {"q": "다이어리나 플래너 사용은?", "a": [
            {"t": "매일 작성", "v": 40},
            {"t": "중요한 일만", "v": 35},
            {"t": "연초에만 의욕", "v": 25},
            {"t": "머릿속 캘린더", "v": 30}
        ]},
        {"q": "집 열쇠는 어디에?", "a": [
            {"t": "정해진 자리", "v": 40},
            {"t": "가방 안 어딘가", "v": 30},
            {"t": "매번 찾음", "v": 20},
            {"t": "도어락이라 필요 없음", "v": 25}
        ]},
        {"q": "옷은 어떻게 정리하시나요?", "a": [
            {"t": "종류별로 깔끔히", "v": 40},
            {"t": "대충 걸어놓음", "v": 25},
            {"t": "의자에 쌓아놓음", "v": 20},
            {"t": "세탁물과 혼재", "v": 15}
        ]},
        {"q": "책상 위 정리 상태는?", "a": [
            {"t": "미니멀하게", "v": 35},
            {"t": "필요한 것만", "v": 30},
            {"t": "이것저것 많이", "v": 25},
            {"t": "정리가 뭔가요", "v": 20}
        ]},
        {"q": "미루던 일을 시작할 때?", "a": [
            {"t": "일단 시작이 반", "v": 30},
            {"t": "계획부터 세움", "v": 35},
            {"t": "더 미룸", "v": 20},
            {"t": "남에게 부탁", "v": 25}
        ]},
    ],
    
    "communication_style": [
        {"q": "메시지 답장 속도는?", "a": [
            {"t": "즉답", "v": 25},
            {"t": "읽고 나중에", "v": 30},
            {"t": "까먹고 안 함", "v": 20},
            {"t": "중요한 것만 빨리", "v": 35}
        ]},
        {"q": "전화 통화 선호도는?", "a": [
            {"t": "문자가 편해", "v": 25},
            {"t": "급한 일만 전화", "v": 30},
            {"t": "전화가 빠름", "v": 35},
            {"t": "전화 공포증", "v": 20}
        ]},
        {"q": "단체 채팅방에서는?", "a": [
            {"t": "적극 참여", "v": 25},
            {"t": "읽기만", "v": 35},
            {"t": "알림 끄고 가끔", "v": 30},
            {"t": "나가고 싶음", "v": 20}
        ]},
        {"q": "이모티콘 사용량은?", "a": [
            {"t": "거의 모든 문장에", "v": 20},
            {"t": "포인트로 가끔", "v": 30},
            {"t": "거의 안 씀", "v": 40},
            {"t": "유료 이모티콘 수집가", "v": 25}
        ]},
        {"q": "영상통화는 언제?", "a": [
            {"t": "자주 함", "v": 25},
            {"t": "가족이랑만", "v": 35},
            {"t": "꼭 필요할 때만", "v": 30},
            {"t": "절대 안 함", "v": 40}
        ]},
    ],
    
    "work_life": [
        {"q": "출근 준비 시간은?", "a": [
            {"t": "30분 컷", "v": 25},
            {"t": "1시간 정도", "v": 30},
            {"t": "2시간은 필요", "v": 35},
            {"t": "5분 만에 가능", "v": 20}
        ]},
        {"q": "퇴근 후 첫 번째 일은?", "a": [
            {"t": "옷 갈아입기", "v": 35},
            {"t": "침대에 누워있기", "v": 25},
            {"t": "저녁 준비", "v": 40},
            {"t": "운동 가기", "v": 30}
        ]},
        {"q": "점심 메뉴 정하기는?", "a": [
            {"t": "아침부터 고민", "v": 30},
            {"t": "가서 정하기", "v": 25},
            {"t": "돌아가며 먹기", "v": 35},
            {"t": "도시락 지참", "v": 40}
        ]},
        {"q": "야근할 때 저녁은?", "a": [
            {"t": "배달 음식", "v": 25},
            {"t": "편의점 도시락", "v": 30},
            {"t": "회사 근처 식당", "v": 35},
            {"t": "굶고 집에서", "v": 20}
        ]},
        {"q": "연차 사용은?", "a": [
            {"t": "계획적으로 사용", "v": 35},
            {"t": "급할 때만", "v": 30},
            {"t": "연말에 몰아서", "v": 25},
            {"t": "못 쓰고 소멸", "v": 40}
        ]},
    ],
    
    "health_wellness": [
        {"q": "비타민은 언제 드시나요?", "a": [
            {"t": "매일 정해진 시간", "v": 40},
            {"t": "생각날 때", "v": 25},
            {"t": "사놓고 안 먹음", "v": 20},
            {"t": "비타민 안 먹음", "v": 30}
        ]},
        {"q": "운동 후 근육통이 오면?", "a": [
            {"t": "뿌듯함", "v": 30},
            {"t": "파스 붙이기", "v": 35},
            {"t": "운동 쉬기", "v": 25},
            {"t": "운동을 안 해서 모름", "v": 20}
        ]},
        {"q": "일일 걸음 수는?", "a": [
            {"t": "1만보 이상", "v": 35},
            {"t": "5천보 정도", "v": 30},
            {"t": "3천보 미만", "v": 25},
            {"t": "측정 안 함", "v": 20}
        ]},
        {"q": "스트레칭은 언제?", "a": [
            {"t": "아침 저녁 규칙적으로", "v": 40},
            {"t": "아플 때만", "v": 25},
            {"t": "가끔 생각날 때", "v": 30},
            {"t": "스트레칭이 뭔가요", "v": 20}
        ]},
        {"q": "물 마시는 습관은?", "a": [
            {"t": "시간 맞춰서", "v": 40},
            {"t": "목마를 때", "v": 25},
            {"t": "텀블러 들고 다니며", "v": 35},
            {"t": "커피가 물 대신", "v": 20}
        ]},
    ],
    
    "relationships_dating": [
        {"q": "연애할 때 연락 빈도는?", "a": [
            {"t": "하루 종일", "v": 20},
            {"t": "적당히", "v": 30},
            {"t": "바쁘면 못 함", "v": 35},
            {"t": "연애 안 함", "v": 25}
        ]},
        {"q": "기념일 챙기기는?", "a": [
            {"t": "100일 단위까지", "v": 20},
            {"t": "1년 단위만", "v": 30},
            {"t": "생일 정도만", "v": 35},
            {"t": "기념일이 뭔가요", "v": 40}
        ]},
        {"q": "썸 탈 때 스타일은?", "a": [
            {"t": "적극적으로 표현", "v": 25},
            {"t": "은근히 티내기", "v": 30},
            {"t": "상대방이 먼저", "v": 35},
            {"t": "썸이 뭔지 모름", "v": 40}
        ]},
        {"q": "이별 후 연락은?", "a": [
            {"t": "완전 차단", "v": 30},
            {"t": "시간 지나면 친구", "v": 35},
            {"t": "필요하면 연락", "v": 25},
            {"t": "이별 경험 없음", "v": 20}
        ]},
        {"q": "소개팅 제안이 들어오면?", "a": [
            {"t": "일단 만나봄", "v": 25},
            {"t": "사진 먼저", "v": 20},
            {"t": "정중히 거절", "v": 35},
            {"t": "소개팅 안 함", "v": 40}
        ]},
    ],
    
    "travel_leisure": [
        {"q": "여행 짐 싸기는?", "a": [
            {"t": "일주일 전부터", "v": 40},
            {"t": "전날 밤에", "v": 25},
            {"t": "당일 아침에", "v": 20},
            {"t": "리스트 작성 후", "v": 35}
        ]},
        {"q": "비행기에서 자리는?", "a": [
            {"t": "창가 필수", "v": 30},
            {"t": "복도 선호", "v": 35},
            {"t": "아무데나", "v": 25},
            {"t": "비행기 안 탐", "v": 40}
        ]},
        {"q": "호텔 체크인 후 첫 행동은?", "a": [
            {"t": "침대 점프", "v": 20},
            {"t": "짐 정리", "v": 35},
            {"t": "욕실 체크", "v": 30},
            {"t": "와이파이 연결", "v": 25}
        ]},
        {"q": "여행 중 길을 잃으면?", "a": [
            {"t": "구글맵 확인", "v": 25},
            {"t": "현지인에게 물어보기", "v": 30},
            {"t": "일단 걸어보기", "v": 20},
            {"t": "택시 타기", "v": 35}
        ]},
        {"q": "기념품 구매는?", "a": [
            {"t": "리스트 작성해서", "v": 35},
            {"t": "예쁜 거 보이면", "v": 25},
            {"t": "공항에서 대충", "v": 30},
            {"t": "안 사옴", "v": 40}
        ]},
    ],
    
    "environment_conscious": [
        {"q": "에코백 사용은?", "a": [
            {"t": "항상 가지고 다님", "v": 40},
            {"t": "차에 보관", "v": 35},
            {"t": "집에만 있음", "v": 25},
            {"t": "비닐봉지 씀", "v": 20}
        ]},
        {"q": "음식물 쓰레기 처리는?", "a": [
            {"t": "매일 버림", "v": 30},
            {"t": "냄새나면 버림", "v": 25},
            {"t": "일주일에 한 번", "v": 35},
            {"t": "음식물 처리기 사용", "v": 40}
        ]},
        {"q": "에어컨 설정 온도는?", "a": [
            {"t": "26도 이상", "v": 40},
            {"t": "24-25도", "v": 35},
            {"t": "22도 이하", "v": 20},
            {"t": "선풍기만 사용", "v": 30}
        ]},
        {"q": "종이 영수증은?", "a": [
            {"t": "전자 영수증 요청", "v": 35},
            {"t": "받고 바로 버림", "v": 25},
            {"t": "보관했다가 정리", "v": 30},
            {"t": "안 받음", "v": 40}
        ]},
        {"q": "빨대 사용은?", "a": [
            {"t": "안 씀", "v": 40},
            {"t": "종이 빨대만", "v": 35},
            {"t": "개인 빨대 지참", "v": 30},
            {"t": "플라스틱 빨대 선호", "v": 20}
        ]},
    ],
    
    "generation_gap": [
        {"q": "카카오톡 프로필 음악은?", "a": [
            {"t": "최신 인기곡", "v": 20},
            {"t": "내 취향 음악", "v": 30},
            {"t": "설정 안 함", "v": 40},
            {"t": "프로필 음악이 뭔지", "v": 45}
        ]},
        {"q": "사진 보정은 어떻게?", "a": [
            {"t": "앱으로 완벽 보정", "v": 20},
            {"t": "필터만 살짝", "v": 25},
            {"t": "원본이 최고", "v": 35},
            {"t": "사진을 안 찍음", "v": 40}
        ]},
        {"q": "'ㅋㅋ'를 칠 때?", "a": [
            {"t": "ㅋㅋㅋㅋㅋㅋ", "v": 20},
            {"t": "ㅋㅋ", "v": 30},
            {"t": "ㅎㅎ", "v": 40},
            {"t": "하하", "v": 45}
        ]},
        {"q": "줄임말 이해도는?", "a": [
            {"t": "다 알아들음", "v": 20},
            {"t": "대충은 앎", "v": 25},
            {"t": "물어봐야 함", "v": 35},
            {"t": "포기함", "v": 45}
        ]},
        {"q": "유행어 따라하기는?", "a": [
            {"t": "자연스럽게 사용", "v": 20},
            {"t": "아는 것만", "v": 30},
            {"t": "어색해서 안 씀", "v": 40},
            {"t": "무슨 말인지 모름", "v": 45}
        ]},
    ]
}

def create_comprehensive_question_pool():
    """Create a comprehensive pool of 1000 unique questions"""
    all_questions = []
    question_id = 0
    
    # Flatten all questions from FRESH_QUESTIONS
    for category, questions in FRESH_QUESTIONS.items():
        for q_data in questions:
            question = {
                "id": f"{category}_{question_id}",
                "category": category.split('_')[0],  # Take first part as main category
                "subcategory": category,
                "q": q_data["q"],
                "a": q_data["a"]
            }
            all_questions.append(question)
            question_id += 1
    
    # Add more variety by creating variations
    variations = []
    time_contexts = ["아침에", "저녁에", "주말에", "평일에", "휴가 중에", "바쁠 때"]
    
    for q in all_questions[:100]:  # Create variations for first 100 questions
        for context in random.sample(time_contexts, 2):
            var_q = q.copy()
            var_q["id"] = f"{var_q['id']}_var_{len(variations)}"
            var_q["q"] = f"{context} {var_q['q']}"
            # Slightly adjust scores
            for answer in var_q["a"]:
                answer["v"] = max(10, min(50, answer["v"] + random.randint(-5, 5)))
            variations.append(var_q)
    
    all_questions.extend(variations)
    
    # Ensure we have exactly 1000 questions
    while len(all_questions) < 1000:
        # Create more unique questions
        base_q = random.choice(all_questions[:300])
        new_q = base_q.copy()
        new_q["id"] = f"{new_q['category']}_gen_{len(all_questions)}"
        
        # Create slight variations
        modifiers = ["정말", "진짜", "보통", "평소에", "요즘"]
        new_q["q"] = f"{random.choice(modifiers)} {new_q['q']}"
        
        # Ensure it's not a duplicate
        if new_q["q"] not in [q["q"] for q in all_questions]:
            all_questions.append(new_q)
    
    # Take exactly 1000 questions
    return all_questions[:1000]

def main():
    # Create backup
    print("Creating backup...")
    with open('data/question-pool-ultra.json', 'r', encoding='utf-8') as f:
        original_data = json.load(f)
    
    backup_filename = f"data/question-pool-ultra.backup.{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    with open(backup_filename, 'w', encoding='utf-8') as f:
        json.dump(original_data, f, ensure_ascii=False, indent=2)
    print(f"Backup saved: {backup_filename}")
    
    # Create new question pool
    print("\nCreating new question pool...")
    new_questions = create_comprehensive_question_pool()
    
    # Shuffle for variety
    random.shuffle(new_questions)
    
    # Create new data structure
    new_data = {
        "version": "2.0.0",
        "generatedAt": datetime.utcnow().isoformat() + 'Z',
        "totalQuestions": len(new_questions),
        "categories": list(set(q["category"] for q in new_questions)),
        "questions": new_questions
    }
    
    # Save new data
    with open('data/question-pool-ultra.json', 'w', encoding='utf-8') as f:
        json.dump(new_data, f, ensure_ascii=False, indent=2)
    
    print(f"\n✅ Successfully created {len(new_questions)} unique questions!")
    print(f"📁 Saved to: data/question-pool-ultra.json")
    
    # Print summary
    category_counts = defaultdict(int)
    for q in new_questions:
        category_counts[q["category"]] += 1
    
    print("\n📊 Category distribution:")
    for cat, count in sorted(category_counts.items()):
        print(f"  {cat}: {count}")
    
    # Show sample questions
    print("\n📝 Sample questions:")
    for i in range(5):
        q = new_questions[i]
        print(f"\n[{i+1}] {q['q']}")
        for a in q['a']:
            print(f"  - {a['t']} ({a['v']}점)")

if __name__ == "__main__":
    main()